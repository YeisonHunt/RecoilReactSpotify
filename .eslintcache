[{"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\reportWebVitals.js":"1","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\App.js":"2","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\views\\Home\\index.js":"3","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\routes\\index.js":"4","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\index.js":"5","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\utils\\index.js":"6","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\api\\index.js":"7","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\recoil\\auth\\atoms.js":"8","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\components\\DebugObserver.js":"9"},{"size":362,"mtime":1606532342484,"results":"10","hashOfConfig":"11"},{"size":277,"mtime":1606616139414,"results":"12","hashOfConfig":"11"},{"size":3107,"mtime":1606614375703,"results":"13","hashOfConfig":"11"},{"size":282,"mtime":1606534979338,"results":"14","hashOfConfig":"11"},{"size":500,"mtime":1606532342484,"results":"15","hashOfConfig":"11"},{"size":1145,"mtime":1606613515263,"results":"16","hashOfConfig":"11"},{"size":172,"mtime":1606600734806,"results":"17","hashOfConfig":"11"},{"size":294,"mtime":1606610862887,"results":"18","hashOfConfig":"11"},{"size":488,"mtime":1606616414565,"results":"19","hashOfConfig":"11"},{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"dztm28",{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"24","messages":"25","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"26"},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"37","messages":"38","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"39"},"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\reportWebVitals.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\App.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\views\\Home\\index.js",["40","41","42","43"],"import React, { useCallback, useEffect, useState } from 'react'\r\nimport { useLocation } from 'react-router-dom'\r\nimport { useRecoilState } from  'recoil'\r\n\r\n//Import atoms\r\nimport { isAuthenticated as isAuthenticatedAtom, spotifyRefreshToken as spotifyRefreshTokenAtom, spotifyTokenResponse as spotifyTokenResponseAtom } from \"../../recoil/auth/atoms\"\r\n\r\n//Components and more\r\n\r\nimport { spotifyAuthCall } from '../../utils'\r\n\r\n//Assets\r\nimport './style.css'\r\nimport homeImage from '../../assets/images/home.jpeg'\r\n\r\nconst spotifyUrl = `https://accounts.spotify.com/authorize?client_id=${process.env.REACT_APP_SPOTIFY_CLIENT_ID}&response_type=code&redirect_uri=${process.env.REACT_APP_SPOTIFY_CALLBACK_HOST}&scope=user-read-private`;\r\n\r\nexport default function Home(){\r\n\r\n    const location = useLocation()\r\n    //const [isAuthenticated, setIsAuthenticated] = useState() old useState way\r\n    const [isAuthenticated, setIsAuthenticated  ] = useRecoilState(isAuthenticatedAtom)\r\n    const [spotifyRefreshToken, setSpotifyRefreshToken ] = useRecoilState(spotifyRefreshTokenAtom)\r\n    const [spotifyTokenResponse, setspotifyTokenResponse ] = useRecoilState(spotifyTokenResponseAtom) \r\n\r\n    const authenticateUser = useCallback(async (code) => {\r\n\r\n        try {\r\n            \r\n            let response;\r\n            // isAuthenticated, responseToken, responseRefresh cada uno de estos seria un atomo\r\n            // Si refreshToken existe, entonces haz una llamada a refreshToken, de lo contrario solicita un token nuevo.\r\n\r\n            if(spotifyRefreshToken){\r\n                response = await  spotifyAuthCall({ refresh_token: spotifyRefreshToken })\r\n            }else {\r\n                response = await spotifyAuthCall({code})\r\n            }\r\n\r\n            console.log(response)\r\n\r\n            setSpotifyRefreshToken(response?.refresh_token)\r\n            setspotifyTokenResponse(response)\r\n            setIsAuthenticated(true)\r\n\r\n            //TODO redirijir a pantalla de buscador\r\n        } catch (error) {\r\n            console.log(\"Error en authenticateUser\" + error)\r\n        }\r\n\r\n\r\n\r\n    }, [setSpotifyRefreshToken, setspotifyTokenResponse, setIsAuthenticated, spotifyRefreshToken])\r\n    \r\n    useEffect(()=>{\r\n        const urlParams = new URLSearchParams(location.search)\r\n        const spotifyCode = urlParams.get(\"code\")\r\n        if (spotifyCode) authenticateUser(spotifyCode) // evitamos llamadas innecesarias\r\n        \r\n    },[location.search]) //este hook se llama cuando algun elemento dentro del array cambia\r\n\r\n    const handleLoginClick = () => {\r\n            window.location.replace(spotifyUrl)\r\n    }\r\n\r\n    return(\r\n        <div className=\"home-container\">\r\n\r\n            <div className=\"home-left-child\">\r\n                <h3>Bienvenido de nuevo</h3>\r\n                <h6>Identificate para encontrar tu musica favorita.</h6>\r\n                <button onClick={handleLoginClick} >Iniciar sesion</button>\r\n            </div>\r\n            <div className=\"home-right-child\" style={{ backgroundImage: `url(${homeImage})` }} />\r\n\r\n\r\n        </div> // end home-container\r\n        \r\n    );\r\n}","C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\routes\\index.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\index.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\utils\\index.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\api\\index.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\recoil\\auth\\atoms.js",[],"C:\\Development\\ReactJS Senior\\spotify_recoil\\src\\components\\DebugObserver.js",["44","45","46"],"import { useRecoilTransactionObserver_UNSTABLE } from 'recoil'\r\nimport { spotifyRefreshToken, spotifyTokenResponse } from '../recoil/auth/atoms'\r\nexport default function DebugObserver(){\r\n\r\n    useRecoilTransactionObserver_UNSTABLE(({snapshot})=>{\r\n\r\n        //TODO persistir la informacion\r\n        for (const modifiedAtom of snapshot.getNodes_UNSTABLE({ isModified:true })){\r\n            const atom = snapshot.getLoadable(modifiedAtom).contents\r\n        }\r\n\r\n    })\r\n    return null;\r\n}",{"ruleId":"47","severity":1,"message":"48","line":1,"column":41,"nodeType":"49","messageId":"50","endLine":1,"endColumn":49},{"ruleId":"47","severity":1,"message":"51","line":22,"column":12,"nodeType":"49","messageId":"50","endLine":22,"endColumn":27},{"ruleId":"47","severity":1,"message":"52","line":24,"column":12,"nodeType":"49","messageId":"50","endLine":24,"endColumn":32},{"ruleId":"53","severity":1,"message":"54","line":60,"column":7,"nodeType":"55","endLine":60,"endColumn":24,"suggestions":"56"},{"ruleId":"47","severity":1,"message":"57","line":2,"column":10,"nodeType":"49","messageId":"50","endLine":2,"endColumn":29},{"ruleId":"47","severity":1,"message":"58","line":2,"column":31,"nodeType":"49","messageId":"50","endLine":2,"endColumn":51},{"ruleId":"47","severity":1,"message":"59","line":9,"column":19,"nodeType":"49","messageId":"50","endLine":9,"endColumn":23},"no-unused-vars","'useState' is defined but never used.","Identifier","unusedVar","'isAuthenticated' is assigned a value but never used.","'spotifyTokenResponse' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'authenticateUser'. Either include it or remove the dependency array.","ArrayExpression",["60"],"'spotifyRefreshToken' is defined but never used.","'spotifyTokenResponse' is defined but never used.","'atom' is assigned a value but never used.",{"desc":"61","fix":"62"},"Update the dependencies array to be: [authenticateUser, location.search]",{"range":"63","text":"64"},[2441,2458],"[authenticateUser, location.search]"]